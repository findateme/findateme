<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5, user-scalable=yes, viewport-fit=cover" />
  <link rel="icon" type="image/svg+xml" href="favicon.svg" />
  <link rel="alternate icon" href="favicon.svg" type="image/svg+xml" />
  <title>DateMe â€” People</title>

  <link rel="stylesheet" href="browser-compatibility.css" />
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="shared-theme.css" />

  <script src="browser-polyfills.js"></script>
  <script src="config.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  
  <!-- CRITICAL: Verify user exists BEFORE loading anything else -->
  <script>
    (async function() {
      try {
        // Get email from localStorage
        const activeEmail = localStorage.getItem("dateme_active_user");
        const localSession = localStorage.getItem("dateme_local_session") === "true";
        
        if (!activeEmail && !localSession) {
          // No session - redirect to login
          window.location.href = "login.html";
          return;
        }
        
        if (activeEmail) {
          // Verify user exists in database
          const API_BASE = window.API_BASE || "https://fin-date-me.onrender.com";
          const response = await fetch(`${API_BASE}/get_users.php?t=${Date.now()}`);
          const data = await response.json();
          
          const userExists = data.ok && data.users && data.users.some(u => 
            String(u.email || "").toLowerCase() === activeEmail.toLowerCase()
          );
          
          if (!userExists) {
            // Account deleted - clear everything and redirect
            console.log("âŒ Account has been deleted");
            localStorage.clear();
            sessionStorage.clear();
            
            // Try to sign out from Supabase if available
            if (window.supabase && window.SUPABASE_URL && window.SUPABASE_ANON_KEY) {
              const sb = window.supabase.createClient(window.SUPABASE_URL, window.SUPABASE_ANON_KEY);
              await sb.auth.signOut();
            }
            
            alert("Your account has been deleted. Please sign up again to use DateMe.");
            window.location.href = "login.html";
            return;
          }
        }
      } catch (err) {
        console.log("Could not verify user:", err.message);
        // Allow page to load on network error
      }
    })();
  </script>
  
  <script src="auth.js" defer></script>
  <script src="app.js" defer></script>
</head>

<body data-page="people">
  <div class="bg-float">
    <div class="orb one"></div>
    <div class="orb two"></div>
    <div class="orb three"></div>
  </div>
   
<div class="hearts">
  <span class="heart" style="left:4%;  animation-duration:34s;"></span>
  <span class="heart" style="left:8%;  animation-duration:38s; animation-delay:6s;"></span>
  <span class="heart" style="left:12%; animation-duration:41s; animation-delay:12s;"></span>

  <span class="heart" style="left:18%; animation-duration:36s; animation-delay:3s;"></span>
  <span class="heart" style="left:22%; animation-duration:44s; animation-delay:9s;"></span>
  <span class="heart" style="left:27%; animation-duration:39s; animation-delay:15s;"></span>

  <span class="heart" style="left:33%; animation-duration:35s; animation-delay:5s;"></span>
  <span class="heart" style="left:38%; animation-duration:46s; animation-delay:11s;"></span>
  <span class="heart" style="left:42%; animation-duration:40s; animation-delay:17s;"></span>

  <span class="heart" style="left:48%; animation-duration:34s; animation-delay:8s;"></span>
  <span class="heart" style="left:54%; animation-duration:45s; animation-delay:14s;"></span>
  <span class="heart" style="left:58%; animation-duration:37s; animation-delay:20s;"></span>

  <span class="heart" style="left:64%; animation-duration:43s; animation-delay:7s;"></span>
  <span class="heart" style="left:69%; animation-duration:36s; animation-delay:13s;"></span>
  <span class="heart" style="left:74%; animation-duration:48s; animation-delay:19s;"></span>

  <span class="heart" style="left:80%; animation-duration:39s; animation-delay:10s;"></span>
  <span class="heart" style="left:86%; animation-duration:44s; animation-delay:16s;"></span>
  <span class="heart" style="left:92%; animation-duration:41s; animation-delay:22s;"></span>
</div>

<!-- ğŸŒŸ Emoji Orbits -->
<div class="emoji-orbit">
  <!-- Top Left Orbit -->
  <div class="orbit-container" style="top: 10%; left: 5%; animation-duration: 20s;">
    <div class="orbit-emoji" style="top: -12px; left: 50%; transform: translateX(-50%);">â¤ï¸</div>
    <div class="orbit-emoji" style="bottom: -12px; left: 50%; transform: translateX(-50%);">ğŸ’•</div>
    <div class="orbit-emoji" style="left: -12px; top: 50%; transform: translateY(-50%);">âœ¨</div>
    <div class="orbit-emoji" style="right: -12px; top: 50%; transform: translateY(-50%);">ğŸ’–</div>
  </div>
  <!-- Right Side Orbit -->
  <div class="orbit-container alt" style="top: 35%; right: 8%; width: 250px; height: 250px; animation-duration: 25s;">
    <div class="orbit-emoji" style="top: -10px; left: 50%; transform: translateX(-50%);">ğŸ’—</div>
    <div class="orbit-emoji" style="bottom: -10px; left: 50%; transform: translateX(-50%);">â­</div>
    <div class="orbit-emoji" style="left: -10px; top: 50%; transform: translateY(-50%);">ğŸ’</div>
    <div class="orbit-emoji" style="right: -10px; top: 50%; transform: translateY(-50%);">ğŸŒ¹</div>
  </div>
  <!-- Bottom Center Orbit -->
  <div class="orbit-container" style="bottom: 15%; left: 50%; transform: translateX(-50%); width: 280px; height: 280px; animation-duration: 30s;">
    <div class="orbit-emoji" style="top: -14px; left: 50%; transform: translateX(-50%);">ğŸ’‘</div>
    <div class="orbit-emoji" style="bottom: -14px; left: 50%; transform: translateX(-50%);">ğŸ’</div>
    <div class="orbit-emoji" style="left: -14px; top: 50%; transform: translateY(-50%);">ğŸ€</div>
    <div class="orbit-emoji" style="right: -14px; top: 50%; transform: translateY(-50%);">ğŸ’˜</div>
  </div>
</div>
  <header class="topbar">
    <div class="topbar__inner">
      <div class="topbar__left">
<a class="logo" href="home.html" aria-label="DateMe Home">
  
  <svg class="logoMark" viewBox="0 0 120 120" role="img" aria-hidden="true">
    
    <path
      d="M60 104
         C60 104, 18 76, 18 42
         C18 22, 34 10, 50 10
         C67 10, 79 23, 84 33
         C89 23, 101 10, 118 10
         C134 10, 150 22, 150 42
         C150 76, 60 104, 60 104 Z"
      fill="none"
      stroke="rgba(255,255,255,.92)"
      stroke-width="8"
      stroke-linejoin="round"
      stroke-linecap="round"
      transform="translate(-24,0)"
    />
    
    <path
      d="M60 100
         C60 100, 24 74, 24 44
         C24 28, 36 18, 50 18
         C64 18, 74 27, 80 36
         C86 27, 96 18, 110 18
         C124 18, 136 28, 136 44
         C136 74, 60 100, 60 100 Z"
      fill="none"
      stroke="rgba(255,77,109,.95)"
      stroke-width="4"
      stroke-linejoin="round"
      stroke-linecap="round"
      transform="translate(-8,0)"
      opacity=".95"
    />
  </svg>

  
  <span class="logoType"><b>Date</b>Me</span>
</a>
      <nav class="nav" aria-label="Primary"></nav>
    </div>

      <div class="topbar__right">
      <div class="topbarSearch">
        <div class="searchBar searchBar--mini">
          <input id="q" class="searchInput" type="text" placeholder="Search username..." />
          <button class="searchBtn searchBtn--premium" id="applyBtn" type="button">Search</button>
        </div>
      </div>
      <button class="iconbtn menuBtn" id="menuBtn" type="button" aria-label="Open menu" onclick="document.getElementById('sideMenu').classList.add('show');document.getElementById('sideMenu').setAttribute('aria-hidden','false');">â˜°</button>
<a class="avatar" title="Profile" href="profile.html" aria-label="My Profile">
  <span class="avatar__icon" aria-hidden="true">ğŸ‘¤</span>
  <img class="avatar__img" alt="" loading="lazy" />
</a>    </div>
    </div>
  </header>

  <main class="layout">
    
     
    
    <section class="content">
      <div class="stories" id="stories"></div>
      <input id="storyInput" type="file" accept="image/*,video/*" hidden />
      <div class="emptyState" id="emptyState" style="display:none;">
        <div class="emptyState__title">No results found</div>
        <div class="muted">Try another name.</div>
      </div>

      <div class="contentTop">
        <div>
          <h1 class="h1">People</h1>
          <p class="muted" style="margin-top:6px">Find matches that actually feel real.</p>
        </div>

        <div class="meta"></div>
      </div>

      <div class="cardbox" id="adminEntry" style="display:none; margin:0 0 14px;">
        <div style="display:flex; justify-content:space-between; align-items:center; gap:12px; flex-wrap:wrap;">
          <div>
            <div style="font-weight:800;">Admin</div>
            <div class="muted" style="font-size:13px;">Open admin tools and conversations.</div>
          </div>
          <a class="btn" href="admin_home.html">Open Admin</a>
        </div>
      </div>

      <div class="grid" id="grid">
        <!-- Initial loading state -->
        <div class="grid-loader" id="gridLoader" style="grid-column: 1/-1; text-align: center; padding: 60px 20px;">
          <div style="display: inline-block; width: 48px; height: 48px; border: 4px solid rgba(255,79,216,0.2); border-top-color: #ff4fd8; border-radius: 50%; animation: spin 0.8s linear infinite;"></div>
          <div style="margin-top: 16px; color: var(--muted);">Loading profiles...</div>
        </div>
      </div>

      <div class="loadWrap">
        <button class="btn primary" id="loadMoreBtn" type="button">Load more</button>
        <div class="spinner" id="spinner" aria-hidden="true"></div>
      </div>
    </section>

    
   
  </main>

  <div class="sideMenu" id="sideMenu" aria-hidden="true">
    <div class="sideMenu__panel">
      <button class="sideMenu__close" id="sideMenuClose" type="button" onclick="document.getElementById('sideMenu').classList.remove('show');document.getElementById('sideMenu').setAttribute('aria-hidden','true');">âœ•</button>
      <button class="sideMenu__row" id="menToggle" type="button">
        <span class="sideMenu__icon">â™€ï¸â™‚ï¸</span>
        <span>Men / Women</span>
        <span class="sideMenu__chev">â€º</span>
      </button>
      <a class="sideMenu__row" href="profile.html">
        <span class="sideMenu__icon">ğŸ‘¤</span>
        <span>My Profile</span>
        <span class="sideMenu__chev">â€º</span>
      </a>
      <a class="sideMenu__row" href="notifications.html">
        <span class="sideMenu__icon">ğŸ””</span>
        <span>Notifications</span>
        <span class="sideMenu__badge" id="notifBadge">0</span>
        <span class="sideMenu__chev">â€º</span>
      </a>
      <a class="sideMenu__row" href="inbox.html">
        <span class="sideMenu__icon">ğŸ’¬</span>
        <span>Inbox</span>
        <span class="sideMenu__badge" id="inboxBadge" style="display:none;">0</span>
        <span class="sideMenu__chev">â€º</span>
      </a>
      <a class="sideMenu__row" href="profile.html">
        <span class="sideMenu__icon">âš™ï¸</span>
        <span>Settings & privacy</span>
        <span class="sideMenu__chev">â€º</span>
      </a>
      <button class="sideMenu__row" id="aboutUsBtn" type="button">
        <span class="sideMenu__icon">ğŸ’™</span>
        <span>About Us</span>
        <span class="sideMenu__chev">â€º</span>
      </button>
      
      <!-- Upgrade Button (Moved up) -->
      <a class="sideMenu__item upgrade" href="profile-upgrade.html" style="margin-top:16px;">
        âœ¨ Upgrade your profile
      </a>
      
      <div class="sideMenu__footer">
        <button class="sideMenu__item logout" id="logoutBtn" type="button">Logout</button>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", async () => {
      const adminEntry = document.getElementById("adminEntry");
      if (!adminEntry) return;
      const adminEmail = String(window.DATEME_ADMIN_EMAIL || "").toLowerCase();
      let email = "";
      try{
        if (window.DateMeAuth && DateMeAuth.getUser){
          const user = await DateMeAuth.getUser();
          email = String(user?.email || "").toLowerCase();
        }
      }catch(e){}
      if (!email){
        try{
          const profile = JSON.parse(localStorage.getItem("dateme_profile") || "{}");
          email = String(profile?.email || "").toLowerCase();
        }catch(e){}
      }
      if (adminEmail && email === adminEmail){
        adminEntry.style.display = "block";
      }
    });
  </script>

  <div class="aboutOverlay" id="aboutOverlay" aria-hidden="true">
    <div class="aboutModal" role="dialog" aria-modal="true" aria-labelledby="aboutTitle">
      <div class="orbit aboutOrbit" aria-hidden="true">
        <span class="orbit__heart h1">ğŸ’—</span>
        <span class="orbit__heart h2">ğŸ’–</span>
        <span class="orbit__heart h3">ğŸ’</span>
        <span class="orbit__heart h4">ğŸ’˜</span>
        <span class="orbit__heart h5">ğŸ’•</span>
        <span class="orbit__heart h6">ğŸ’œ</span>
        <span class="orbit__heart h7">ğŸ’“</span>
        <span class="orbit__heart h8">ğŸ’</span>
      </div>
      <button class="aboutClose" id="aboutClose" type="button" aria-label="Close">âœ•</button>
      <h2 id="aboutTitle">ğŸ’™ About Us â€“ DateMe</h2>
      <div class="aboutBody">
        <p>DateMe was founded in 2025 with one simple idea:<br>dating should feel real again.</p>
        <p>In a world full of swipe fatigue, fake profiles, and endless conversations that go nowhere, we set out to build a platform focused on genuine human connection.</p>
        <p>DateMe is a modern dating platform designed for people who value authenticity, privacy, and meaningful conversations. We help singles meet others who are serious about building real connectionsâ€”not just swiping.</p>
        <p>Trust and safety are at the core of everything we do. Thatâ€™s why DateMe focuses on:</p>
        <ul>
          <li>Real profiles, not bots</li>
          <li>Strong privacy and safety tools</li>
          <li>Respectful communication</li>
          <li>Transparent user-first policies</li>
        </ul>
        <p>Built for the modern generation, DateMe supports privacy-focused payments, including crypto, giving members more control over how they engage with the platform.</p>
        <p>Weâ€™re starting in New York City, growing our community carefully and intentionally, with plans to expand across the United States.</p>
        <p>At DateMe, weâ€™re not here to replace real lifeâ€”weâ€™re here to help you find someone worth meeting in it.</p>
        <p>Join DateMe and start something real.</p>
      </div>
    </div>
  </div>

  
  <div class="storyModal" id="storyModal" aria-hidden="true">
    <div class="storyModal__backdrop" id="storyModalClose"></div>
    <div class="storyModal__panel" role="dialog" aria-modal="true">
      <button class="storyModal__x" id="storyModalX" title="Close" type="button">âœ•</button>
      <div class="storyModal__body">
        <div class="storyModal__media" id="storyModalMedia">
          <img id="storyModalImg" alt="" style="display:none;" />
          <video id="storyModalVideo" alt="" style="display:none; width: 100%; height: 100%; object-fit: cover;"></video>
          <div class="storyModal__timer" id="storyModalTimer" style="display:none; position:absolute; top:10px; right:10px; background:rgba(0,0,0,.6); color:white; padding:6px 12px; border-radius:4px; font-size:12px; font-weight:600;"></div>
          <div class="storyModal__lock">
            <div class="storyModal__lockIcon">ğŸ”’</div>
            <div class="storyModal__lockTitle">Locked Story</div>
            <div class="storyModal__lockText">Unlock to view full story.</div>
            <a class="btn primary" href="profile-upgrade.html">Unlock Premium</a>
          </div>
        </div>
        <div class="storyModal__info">
          <h3 id="storyModalName">Story</h3>
          <p class="muted">Stories are premium-only. Upgrade to view.</p>
          
          <!-- Story Reactions -->
          <div id="storyReactionsSection" style="display:none; margin-top:16px;">
            <div style="display:flex; align-items:center; gap:8px; margin-bottom:8px;">
              <span style="font-size:14px; font-weight:600;">Reactions</span>
              <span id="storyReactionCount" style="font-size:12px; color:var(--muted2);">0</span>
            </div>
            <div id="storyReactionsList" style="display:flex; gap:4px; flex-wrap:wrap; margin-bottom:12px;"></div>
          </div>
          
          <!-- Story Comments -->
          <div id="storyCommentsSection" style="display:none; margin-top:16px;">
            <div style="display:flex; align-items:center; gap:8px; margin-bottom:12px;">
              <span style="font-size:14px; font-weight:600;">Comments</span>
              <span id="storyCommentCount" style="font-size:12px; color:var(--muted2);">0</span>
            </div>
            <div id="storyCommentsList" style="max-height:200px; overflow-y:auto; margin-bottom:12px; display:flex; flex-direction:column; gap:10px;"></div>
            <div id="storyCommentInputArea" style="display:none;">
              <input type="text" id="storyCommentInput" placeholder="Write a comment..." style="width:100%; padding:10px; border:1px solid var(--stroke); border-radius:8px; background:var(--card); color:var(--text); font-size:14px;" />
              <button id="storyCommentSendBtn" class="btn primary" type="button" style="margin-top:8px; width:100%;">Send</button>
            </div>
          </div>
          
          <div id="storyModalActions" style="display:flex; gap:8px; margin-top:12px; flex-wrap:wrap;">
            <button id="storyReactBtn" class="btn" type="button" style="display:none;">ğŸ‘ React</button>
            <button id="storyCommentBtn" class="btn" type="button" style="display:none;">ğŸ’¬ Comment</button>
            <button id="storyDeleteBtn" class="btn" type="button" style="display:none;">ğŸ—‘ Delete</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  
  <div class="welcomeModal" id="welcomeModal" aria-hidden="true">
    <div class="welcomeModal__backdrop" id="welcomeClose"></div>
    <div class="welcomeModal__panel" role="dialog" aria-modal="true">
      <div class="welcomeBadge">Welcome âœ¨</div>
      <h2 class="welcomeTitle">Welcome, <span id="welcomeName">Friend</span>!</h2>
      <p class="welcomeLead">Your account is ready.</p>
      <p id="welcomeMsg" class="muted">Letâ€™s find someone worth meeting.</p>
      <button class="btn primary" id="welcomeOk" type="button">OK</button>
    </div>
  </div>

  <div class="welcomeModal" id="userWelcomeModal" aria-hidden="true">
    <div class="welcomeModal__backdrop" id="userWelcomeClose"></div>
    <div class="welcomeModal__panel" role="dialog" aria-modal="true">
      <div class="welcomeBadge">ğŸ’– Welcome, love!</div>
      <h2 class="welcomeTitle">Thanks for signing up on DateMe</h2>
      <p class="muted">Your account is securedâ€”continue to explore DateMe.</p>
      <div style="display:flex; gap:10px; justify-content:center; margin-top:12px; flex-wrap:wrap;">
        <button class="btn primary" id="userWelcomeExplore" type="button">Explore</button>
        <a class="btn ghost" href="profile-upgrade.html">Upgrade</a>
      </div>
    </div>
  </div>

  <div class="welcomeModal" id="upgradeCongratsModal" aria-hidden="true">
    <div class="welcomeModal__backdrop" id="upgradeCongratsClose"></div>
    <div class="welcomeModal__panel" role="dialog" aria-modal="true">
      <div class="welcomeBadge">ğŸ‰ Congratulations</div>
      <h2 class="welcomeTitle">Premium Activated</h2>
      <p class="muted">Unlimited messages and full stories are now unlocked.</p>
      <button class="btn primary" id="upgradeCongratsOk" type="button">Go to Home</button>
    </div>
  </div>

  
  <div class="modal" id="modal" aria-hidden="true">
    <div class="modal__backdrop" id="modalClose"></div>
    <div class="modal__panel" role="dialog" aria-modal="true">
      <button class="modal__x" id="modalX" title="Close" type="button">âœ•</button>

      <div class="modal__body">
        <div class="modal__img">
          <img id="mImg" alt="" />
          <span class="badge" id="mBadge">ONLINE</span>
        </div>

        <div class="modal__info">
          <h2 id="mName">Name</h2>
          <p class="muted" id="mMeta">â€”</p>

          <div class="chips" id="mChips"></div>

          <div class="modal__actions">
            <button class="btn primary" id="chatBtn" type="button">Chat now</button>
            <button class="btn" id="likeBtn" type="button">â™¡ Like</button>
        </div>
          <div class="note" id="mNote"></div>
        </div>
      </div>
    </div>
  </div>

<div id="chatPanel" class="chatPanel" style="display:none">
  <div class="chatHead">
    <div>
      <b id="chatWith">Chat</b>
      <div id="chatStatus" class="muted" style="font-size:12px;margin-top:2px"></div>
    </div>
    <button id="chatCloseBtn" class="iconbtn" type="button">âœ•</button>
  </div>

  <div id="chatBody" class="chatBody"></div>

  <form id="chatForm" class="chatForm">
    <input id="chatInput" class="chatInput" placeholder="Type a messageâ€¦" autocomplete="off" />
    <button class="pill" type="submit">Send</button>
  </form>
</div>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    const btn = document.getElementById("menuBtn");
    const menu = document.getElementById("sideMenu");
    const close = document.getElementById("sideMenuClose");
    if (btn && menu) {
      btn.addEventListener("click", () => {
        menu.classList.add("show");
        menu.setAttribute("aria-hidden","false");
      });
    }
    if (close && menu) {
      close.addEventListener("click", () => {
        menu.classList.remove("show");
        menu.setAttribute("aria-hidden","true");
      });
    }
  });
</script>
<script src="people.js"></script>
<script src="search-users.js"></script>
<script src="keep-alive.js"></script>
</body>
</html>
